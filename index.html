<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gestão de Frota - 18º BPM/I</title>
  <style>
    :root{
      --amarelo:#FFFF00;
      --amarelo-neon:#f9ff7a;
      --cinza:#cfcfcf;
      --cinza-escuro:#777;
      --bg:#000000;
      --card-bg:rgba(10,10,15,0.96);
      --radius:16px;
      --shadow:0 18px 45px rgba(0,0,0,0.9);
    }
    *{box-sizing:border-box;margin:0;padding:0;}
    body{
      min-height:100vh;
      font-family:Arial,Helvetica,sans-serif;
      background:
        radial-gradient(circle at top,#222 0,#050509 55%,#000 100%);
      color:var(--amarelo);
      display:flex;
      flex-direction:column;
    }

    header{
      padding:14px 18px 10px;
      border-bottom:1px solid rgba(255,255,255,0.18);
      background:
        linear-gradient(90deg,#000 0,#111 40%,#000 100%);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:16px;
      flex-wrap:wrap;
    }
    .titulo-box{
      display:flex;
      flex-direction:column;
      gap:4px;
      min-width:230px;
    }
    .titulo{
      font-size:1.3rem;
      letter-spacing:1px;
      text-transform:uppercase;
    }
    .subtitulo{
      font-size:0.8rem;
      color:var(--cinza);
    }
    .badge-sistema{
      border:1px solid rgba(255,255,255,0.35);
      border-radius:999px;
      padding:4px 14px;
      font-size:0.75rem;
      text-transform:uppercase;
      letter-spacing:0.1em;
      display:inline-flex;
      align-items:center;
      gap:6px;
      background:rgba(0,0,0,0.75);
    }
    .badge-dot{
      width:9px;
      height:9px;
      border-radius:999px;
      background:var(--amarelo-neon);
      box-shadow:0 0 10px var(--amarelo-neon);
    }

    main{
      flex:1;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px 16px;
    }

    .container{
      width:100%;
      max-width:1040px;
      display:flex;
      flex-direction:column;
      gap:16px;
    }

    .intro{
      font-size:0.85rem;
      color:var(--cinza);
    }

    .grid-companhias{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
      gap:16px;
      margin-top:8px;
    }

    .card-cia{
      background:var(--card-bg);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      border:1px solid rgba(255,255,255,0.08);
      padding:14px 16px;
      cursor:pointer;
      transition:transform 0.12s ease, box-shadow 0.12s ease, border-color 0.12s ease;
      position:relative;
      overflow:hidden;
    }
    .card-cia::before{
      content:"";
      position:absolute;
      inset:0;
      background:radial-gradient(circle at top,rgba(255,255,0,0.12),transparent 55%);
      opacity:0;
      transition:opacity 0.15s ease;
      pointer-events:none;
    }
    .card-cia:hover{
      transform:translateY(-3px);
      border-color:rgba(255,255,120,0.7);
      box-shadow:0 22px 50px rgba(0,0,0,0.95);
    }
    .card-cia:hover::before{
      opacity:1;
    }

    .card-cia-titulo{
      font-size:1rem;
      text-transform:uppercase;
      letter-spacing:0.1em;
      margin-bottom:4px;
    }
    .card-cia-sub{
      font-size:0.8rem;
      color:var(--cinza);
      margin-bottom:10px;
    }
    .card-cia-tag{
      font-size:0.7rem;
      text-transform:uppercase;
      letter-spacing:0.12em;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.25);
      padding:3px 10px;
      display:inline-block;
      background:rgba(0,0,0,0.7);
      color:var(--cinza);
    }
    .card-cia-footer{
      margin-top:10px;
      font-size:0.72rem;
      color:var(--cinza-escuro);
    }

    @media(max-width:700px){
      main{
        align-items:flex-start;
        padding-top:18px;
      }
    }
  /* ===== MODAL DE LOGIN (TELA CHEIA) ===== */
.login-overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.82);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:999;
  backdrop-filter:blur(5px);
}
.login-overlay.hidden{
  display:none;
}
.login-modal{
  background:rgba(10,10,15,0.98);
  border-radius:22px;
  box-shadow:0 26px 70px rgba(0,0,0,0.95);
  border:1px solid rgba(255,255,255,0.25);
  padding:22px 22px 18px;
  width:100%;
  max-width:360px;
}
.login-modal-titulo{
  font-size:1.05rem;
  text-transform:uppercase;
  letter-spacing:0.16em;
  margin-bottom:6px;
}
.login-modal-sub{
  font-size:0.8rem;
  color:var(--cinza);
  margin-bottom:12px;
}
.login-alvo{
  font-size:0.75rem;
  color:var(--cinza);
  margin-bottom:6px;
}
.login-modal-form{
  display:flex;
  flex-direction:column;
  gap:10px;
}
.login-modal-form label{
  font-size:0.7rem;
  text-transform:uppercase;
  letter-spacing:0.11em;
  color:var(--cinza);
  margin-bottom:2px;
}
.login-modal-form input{
  width:100%;
  padding:7px 11px;
  font-size:0.86rem;
  border-radius:999px;
  border:1px solid rgba(255,255,255,0.3);
  background:#050509;
  color:var(--amarelo);
  outline:none;
}
.login-modal-form input:focus{
  border-color:var(--amarelo-neon);
  box-shadow:0 0 0 1px rgba(255,255,120,0.5);
}
.login-modal-actions{
  display:flex;
  justify-content:flex-end;
  gap:8px;
  margin-top:10px;
}
.btn-login-primary,
.btn-login-cancel{
  border:none;
  border-radius:999px;
  padding:6px 16px;
  font-size:0.8rem;
  text-transform:uppercase;
  letter-spacing:0.14em;
  cursor:pointer;
}
.btn-login-primary{
  background:linear-gradient(135deg,var(--amarelo-neon),var(--amarelo));
  color:#000;
  font-weight:600;
  box-shadow:0 0 16px rgba(255,255,120,0.65);
}
.btn-login-cancel{
  background:rgba(0,0,0,0.9);
  color:var(--cinza);
  border:1px solid rgba(255,255,255,0.3);
}
.login-erro{
  font-size:0.75rem;
  color:#ff8080;
  min-height:1.1em;
  margin-top:2px;
}

  </style>
</head>
<body>
<header>
  <div class="titulo-box">
    <div class="titulo">Gestão de Frota · 18º BPM/I</div>
    <div class="subtitulo">Selecione o painel desejado</div>
  </div>

  <div class="badge-sistema">
    <span class="badge-dot"></span>
    <span>Sistema Online · Uso Interno</span>
  </div>
</header>

<main>
  <div class="container">
    <div class="intro">
      Clique no módulo desejado. O sistema solicitará login antes de abrir o painel da Companhia ou do Batalhão.
    </div>

    <div class="grid-companhias">
      <div class="card-cia" data-target="frota_cia1.html">
        <div class="card-cia-titulo">1ª Cia PM</div>
        <div class="card-cia-sub">Painel de gestão de frota da 1ª Companhia.</div>
        <span class="card-cia-tag">Presidente Prudente</span>
        <div class="card-cia-footer">Clique para abrir o painel da 1ª Cia.</div>
      </div>

      <div class="card-cia" data-target="frota_cia2.html">
        <div class="card-cia-titulo">2ª Cia PM</div>
        <div class="card-cia-sub">Painel de gestão de frota da 2ª Companhia.</div>
        <span class="card-cia-tag">Martinópolis e região</span>
        <div class="card-cia-footer">Clique para abrir o painel da 2ª Cia.</div>
      </div>

      <div class="card-cia" data-target="frota_cia3.html">
        <div class="card-cia-titulo">3ª Cia PM</div>
        <div class="card-cia-sub">Painel de gestão de frota da 3ª Companhia.</div>
        <span class="card-cia-tag">Pirapozinho e região</span>
        <div class="card-cia-footer">Clique para abrir o painel da 3ª Cia.</div>
      </div>

      <div class="card-cia" data-target="frota_cia4.html">
        <div class="card-cia-titulo">4ª Cia PM</div>
        <div class="card-cia-sub">Painel de gestão de frota da 4ª Companhia.</div>
        <span class="card-cia-tag">Álvares Machado e região</span>
        <div class="card-cia-footer">Clique para abrir o painel da 4ª Cia.</div>
      </div>

      <div class="card-cia" data-target="frota_cia5.html">
        <div class="card-cia-titulo">5ª Cia PM</div>
        <div class="card-cia-sub">Painel de gestão de frota da 5ª Companhia.</div>
        <span class="card-cia-tag">Presidente Prudente</span>
        <div class="card-cia-footer">Clique para abrir o painel da 5ª Cia.</div>
      </div>

      <div class="card-cia" data-target="frota_cia_ft.html">
        <div class="card-cia-titulo">Cia FT</div>
        <div class="card-cia-sub">Painel de gestão de frota da Força Tática.</div>
        <span class="card-cia-tag">Atuação em toda a região do 18º BPM/I</span>
        <div class="card-cia-footer">Clique para abrir o painel da Cia FT.</div>
      </div>

      <div class="card-cia" data-target="frota_batalhao.html">
        <div class="card-cia-titulo">18º BPM/I - Visão Geral</div>
        <div class="card-cia-sub">Painel consolidado de todas as Companhias com filtros por Cia.</div>
        <span class="card-cia-tag">P/4 - Logística / Batalhão</span>
        <div class="card-cia-footer">Clique para abrir o painel geral do 18º BPM/I.</div>
      </div>
    </div>
  </div>
</main>

<div id="loginOverlay" class="login-overlay hidden">
  <div class="login-modal">
    <div class="login-modal-titulo">Acesso restrito</div>
    <div class="login-modal-sub">Informe login e senha para abrir o painel selecionado.</div>
    <div class="login-alvo" id="loginAlvo"></div>
    <form id="loginForm" class="login-modal-form">
      <div>
        <label for="loginUserModal">Login</label>
        <input id="loginUserModal" autocomplete="off" />
      </div>
      <div>
        <label for="loginPassModal">Senha</label>
        <input id="loginPassModal" type="password" />
      </div>
      <div class="login-erro" id="loginErro"></div>
      <div class="login-modal-actions">
        <button type="button" class="btn-login-cancel" id="btnLoginCancel">Cancelar</button>
        <button type="submit" class="btn-login-primary">Entrar</button>
      </div>
    </form>
  </div>
</div>

<script type="module">
  import { usuariosAutorizados } from "./logins.js";

  const overlay    = document.getElementById("loginOverlay");
  const form       = document.getElementById("loginForm");
  const inputUser  = document.getElementById("loginUserModal");
  const inputPass  = document.getElementById("loginPassModal");
  const msgErro    = document.getElementById("loginErro");
  const lblAlvo    = document.getElementById("loginAlvo");
  const btnCancel  = document.getElementById("btnLoginCancel");

  let destinoModulo = null;
  let moduloAlvo    = null;

  function obterChaveModulo(destino){
    if (!destino) return null;
    const url = destino.toLowerCase();
    if (url.includes("cia1"))      return "1CIA";
    if (url.includes("cia2"))      return "2CIA";
    if (url.includes("cia3"))      return "3CIA";
    if (url.includes("cia4"))      return "4CIA";
    if (url.includes("cia5"))      return "5CIA";
    if (url.includes("cia_ft"))    return "FT";
    if (url.includes("em"))        return "EM";
    if (url.includes("batalhao"))  return "BTL";
    return null;
  }

  function abrirModal(destino, tituloAlvo){
    destinoModulo = destino;
    moduloAlvo    = obterChaveModulo(destino);
    msgErro.textContent = "";
    inputUser.value = "";
    inputPass.value = "";
    lblAlvo.textContent = tituloAlvo ? ("Painel: " + tituloAlvo) : "";
    overlay.classList.remove("hidden");
    setTimeout(() => inputUser.focus(), 50);
  }

  function fecharModal(){
    overlay.classList.add("hidden");
    destinoModulo = null;
    moduloAlvo    = null;
  }

  document.querySelectorAll(".card-cia").forEach(card => {
    card.addEventListener("click", () => {
      const destino = card.getAttribute("data-target");
      if (!destino) return;
      const titulo  = card.querySelector(".card-cia-titulo")?.textContent?.trim() || "";
      abrirModal(destino, titulo);
    });
  });

  btnCancel.addEventListener("click", () => {
    fecharModal();
  });

  overlay.addEventListener("click", (e) => {
    if (e.target === overlay){
      fecharModal();
    }
  });

  form.addEventListener("submit", (e) => {
    e.preventDefault();
    if (!destinoModulo){
      msgErro.textContent = "Nenhum painel selecionado.";
      return;
    }
    if (!moduloAlvo){
      msgErro.textContent = "Painel desconhecido.";
      return;
    }

    const login = inputUser.value.trim();
    const senha = inputPass.value.trim();

    if (!login || !senha){
      msgErro.textContent = "Informe login e senha.";
      return;
    }

    const usuario = usuariosAutorizados.find(u =>
      u.login.toLowerCase() === login.toLowerCase() &&
      u.senha === senha
    );

    if (!usuario){
      msgErro.textContent = "Login ou senha inválidos.";
      return;
    }

    if (usuario.modulos && !usuario.modulos.includes(moduloAlvo)){
      msgErro.textContent = "Seu usuário não possui acesso a este painel.";
      return;
    }

    window.location.href = destinoModulo;
  });
</script>


</body>
</html>
